# =============================================================================
# Excel CLI vs MCP Server Comparison Test
# =============================================================================
#
# Purpose: Compare CLI and MCP Server for the same task
#   - Token usage
#   - Execution speed (latency)
#   - Tool call count
#
# Test: Create workbook with two sheets and data (Budget Tracker)
#
# Prerequisites:
#   - Windows 10/11 with Excel installed
#   - Both CLI and MCP Server available
#   - Environment: AZURE_OPENAI_ENDPOINT, CLI_COMMAND, SERVER_COMMAND
#
# =============================================================================

criteria:
  success_rate: 1  # 100% required

ai_summary:
  enabled: true
  judge_provider: azure-openai-judge

providers:
  - name: azure-openai-gpt41
    type: AZURE
    auth_type: entra_id
    model: gpt-4.1
    baseUrl: "{{AZURE_OPENAI_ENDPOINT}}"
    version: 2025-01-01-preview
  - name: azure-openai-judge
    type: AZURE
    auth_type: entra_id
    model: gpt-4.1
    baseUrl: "{{AZURE_OPENAI_ENDPOINT}}"
    version: 2025-01-01-preview

servers:
  # CLI Server
  - name: excel-cli
    type: cli
    command: "{{CLI_COMMAND}}"
    shell: powershell
    working_dir: "{{TEMP_DIR}}"
    tool_prefix: excel

  # MCP Server (stdio)
  - name: excel-mcp
    type: stdio
    command: "{{SERVER_COMMAND}}"
    server_delay: 30s

agents:
  # CLI Agent using GPT-4.1
  - name: cli-gpt41
    servers:
      - name: excel-cli
    provider: azure-openai-gpt41
    skill:
      path: "{{SKILL_PATH_CLI}}"
      file_access: true
    clarification_detection:
      enabled: true
      judge_provider: azure-openai-judge

  # MCP Agent using GPT-4.1
  - name: mcp-gpt41
    servers:
      - name: excel-mcp
    provider: azure-openai-gpt41
    skill:
      path: "{{SKILL_PATH_MCP}}"
      file_access: true
    clarification_detection:
      enabled: true
      judge_provider: azure-openai-judge

settings:
  verbose: true
  max_iterations: 15


sessions:
  # ==========================================================================
  # Budget Tracker Test - Same task for CLI and MCP
  # ==========================================================================
  - name: "Budget Tracker Comparison"
    tests:
      - name: "Create workbook with sheets and data"
        prompt: |
          Create a new Excel file at {{TEMP_DIR}}/budget-{{randomValue type='UUID'}}.xlsx

          Set it up with two sheets: Income and Expenses.

          On the Income sheet, add this data starting at A1:
          - Headers: Source, Amount
          - Salary: 5000
          - Freelance: 1200

          On the Expenses sheet, add:
          - Headers: Category, Amount
          - Rent: 1500
          - Utilities: 200
          - Food: 600

          Save the file when done.
        assertions:
          - type: no_clarification_questions
          - type: no_hallucinated_tools
          - type: no_rate_limit_errors
